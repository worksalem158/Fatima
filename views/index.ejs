<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…ØªØ¬Ø± ÙØ·ÙŠÙ…Ø©</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Cairo', sans-serif; background-color: #f8f9fa; }
        .product-img { width: 60px; height: 60px; object-fit: cover; border-radius: 8px; }
        .status-paid { background-color: #d1e7dd; color: #0f5132; }
        .status-unpaid { background-color: #f8d7da; color: #842029; }
        .card { border: none; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .navbar { background: linear-gradient(45deg, #0d6efd, #0dcaf0); }
        .navbar-brand, .nav-link { color: white !important; font-weight: bold; }
    </style>
</head>
<body>

    <nav class="navbar navbar-expand-lg mb-4">
        <div class="container">
            <a class="navbar-brand" href="/">
                <span style="font-size: 1.5rem;">ğŸ›ï¸ Ù…ØªØ¬Ø± ÙØ·ÙŠÙ…Ø©</span>
            </a>
            <a href="/create" class="btn btn-light text-primary fw-bold rounded-pill px-4">+ Ø²Ø¨ÙˆÙ† Ø¬Ø¯ÙŠØ¯</a>
        </div>
    </nav>

    <div class="container">
        <% if (customers.length === 0) { %>
            <div class="text-center py-5 text-muted">
                <h4>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø²Ø¨Ø§Ø¦Ù† Ø­Ø§Ù„ÙŠØ§Ù‹</h4>
                <p>Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ø²Ø¨ÙˆÙ† Ù„ÙˆØ§Ù„Ø¯ØªÙƒ â¤ï¸</p>
            </div>
        <% } %>

        <div class="row">
            <% customers.forEach(customer => { %>
                <div class="col-md-6 col-lg-4 mb-4">
                    <div class="card h-100">
                        <div class="card-header bg-white d-flex justify-content-between align-items-center">
                            <h5 class="m-0 text-primary"><%= customer.name %></h5>
                            <button class="btn btn-sm btn-outline-primary" data-bs-toggle="modal" data-bs-target="#modal-<%= customer.id %>">
                                + Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬
                            </button>
                        </div>
                        <div class="card-body p-0">
                            <ul class="list-group list-group-flush">
                                <% customer.products.forEach(product => { %>
                                    <li class="list-group-item d-flex align-items-center justify-content-between">
                                        <div class="d-flex align-items-center">
                                            <img src="<%= product.image %>" class="product-img ms-2" alt="ØµÙˆØ±Ø©">
                                            <div>
                                                <div class="fw-bold"><%= product.name %></div>
                                                <small class="text-muted"><%= product.price %> Ø¯.Ø¬</small>
                                            </div>
                                        </div>
                                        <span class="badge rounded-pill <%= product.status === 'paid' ? 'status-paid' : 'status-unpaid' %>">
                                            <%= product.status === 'paid' ? 'ØªÙ… Ø§Ù„Ø¯ÙØ¹' : 'Ø¢Ø¬Ù„' %>
                                        </span>
                                    </li>
                                <% }) %>
                            </ul>
                        </div>
                        <div class="card-footer bg-white text-center">
                            <small class="text-muted">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: 
                                <%= customer.products.reduce((acc, curr) => acc + curr.price, 0) %> Ø¯.Ø¬
                            </small>
                        </div>
                    </div>

                    <div class="modal fade" id="modal-<%= customer.id %>" tabindex="-1">
                        <div class="modal-dialog">
                            <div class="modal-content">
                                <form action="/add-product/<%= customer.id %>" method="POST" enctype="multipart/form-data">
                                    <div class="modal-header">
                                        <h5 class="modal-title">Ø¥Ø¶Ø§ÙØ© Ù…Ù†ØªØ¬ Ù„Ù€: <%= customer.name %></h5>
                                        <button type="button" class="btn-close m-0" data-bs-dismiss="modal"></button>
                                    </div>
                                    <div class="modal-body">
                                        <div class="mb-3">
                                            <label>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</label>
                                            <input type="text" name="productName" class="form-control" required>
                                        </div>
                                        <div class="mb-3">
                                            <label>Ø§Ù„Ø³Ø¹Ø±</label>
                                            <input type="number" name="price" class="form-control" required>
                                        </div>
                                        <div class="mb-3">
                                            <label>Ø­Ø§Ù„Ø© Ø§Ù„Ø¯ÙØ¹</label>
                                            <select name="status" class="form-select">
                                                <option value="paid">Ù…Ø¯ÙÙˆØ¹ (Ø®Ø§Ù„Øµ)</option>
                                                <option value="unpaid">Ø¢Ø¬Ù„ (ÙƒØ±ÙŠØ¯ÙŠ)</option>
                                            </select>
                                        </div>
                                        <div class="mb-3">
                                            <label>ØµÙˆØ±Ø© Ø§Ù„Ù…Ù†ØªØ¬</label>
                                            <input type="file" name="image" class="form-control" accept="image/*">
                                        </div>
                                    </div>
                                    <div class="modal-footer">
                                        <button type="submit" class="btn btn-primary w-100">Ø­ÙØ¸ Ø§Ù„Ù…Ù†ØªØ¬</button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>

                </div>
            <% }) %>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
